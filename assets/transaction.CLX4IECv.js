import{_ as g}from"./ValaxyMain.vue_vue_type_style_index_0_lang.CDNibFOu.js";import{e as d,a as y,u as b}from"./chunks/vue-router.CwVjGBxy.js";import{N as v,a3 as l,U as m,S as s,W as a,u as k,O as w,E as f}from"./framework.CKsHIdWx.js";import"./app.CmA0qfZP.js";import"./chunks/dayjs.CCYrSalk.js";import"./chunks/@vueuse/motion.ClL2VSPB.js";import"./chunks/vue-i18n.CsQzXKWS.js";import"./chunks/pinia.sS_t_ppk.js";import"./chunks/nprogress.BahbDzmd.js";import"./YunComment.vue_vue_type_style_index_0_lang.W6MzDCJn.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.BVfBHuM-.js";import"./post.BO2M9Fgu.js";const x=d("/posts/transaction",async t=>JSON.parse('{"title":"憧憬成为 web3 高手之：Ethereum 交易与签名","description":"","frontmatter":{"copyright":false,"title":"憧憬成为 web3 高手之：Ethereum 交易与签名","date":"2024-07-15","updated":"2024-07-16","categories":"Web3相关","tags":["web3","ethereum"]},"headers":[],"relativePath":"pages/posts/transaction.md","lastUpdated":1750994524000}'),{lazy:(t,e)=>t.name===e.name}),C={__name:"transaction",setup(t,{expose:e}){var c;const{data:r}=x(),h=b(),o=y(),i=Object.assign(o.meta.frontmatter||{},((c=r.value)==null?void 0:c.frontmatter)||{});return h.currentRoute.value.data=r.value,f("valaxy:frontmatter",i),globalThis.$frontmatter=i,e({frontmatter:{copyright:!1,title:"憧憬成为 web3 高手之：Ethereum 交易与签名",date:"2024-07-15",updated:"2024-07-16",categories:"Web3相关",tags:["web3","ethereum"]}}),(n,p)=>{const u=g;return w(),v(u,{frontmatter:k(i)},{"main-content-md":l(()=>p[0]||(p[0]=[s("h1",{id:"交易",tabindex:"-1"},[a("交易 "),s("a",{class:"header-anchor",href:"#交易","aria-label":'Permalink to "交易"'},"​")],-1),s("p",null,[a("交易是由"),s("strong",null,"外部账户"),a("发起的"),s("strong",null,"签名"),a("消息。")],-1),s("p",null,"是唯一可以触发状态更改或者导致合约在 EVM 执行的东西",-1),s("h2",{id:"交易的结构",tabindex:"-1"},[a("交易的结构 "),s("a",{class:"header-anchor",href:"#交易的结构","aria-label":'Permalink to "交易的结构"'},"​")],-1),s("ul",null,[s("li",null,"nonce: 由 EOA 发起的序列号，防止消息被重拨"),s("li",null,"gas price: 发起人愿意支付的 gas 价格"),s("li",null,"start gas: 发起人愿意支付的最大 gas 量"),s("li",null,"to: 目标以太坊地址"),s("li",null,"value: 发送到目标地址的 ether 数量"),s("li",null,"data: 变长二进制数据"),s("li",null,"v, r, s: 始发EOA的ECDSA签名的三个组成部分")],-1),s("p",null,[a("交易消息结构使用 "),s("code",null,"递归长度前缀(RLP)"),a(" 编码方案经行序列化，RLP 的长度前缀用于标识每个字段的长度，超出定义长度的任何内容属于结构中的下一字段。以太坊中所有数字都被编码为大端序整数，长度为8的倍数。")],-1),s("h3",{id:"nonce",tabindex:"-1"},[a("nonce "),s("a",{class:"header-anchor",href:"#nonce","aria-label":'Permalink to "nonce"'},"​")],-1),s("p",null,"与次地址发送的交易数量相等的标量值，对于具有关联代码的账户，表示账户创建的交易数量。",-1),s("p",null,"nonce 是始发地址的一个属性，但并未作为账户的一部分显式存储在区块链中，根据来源此地址的已确认的数量动态计算的。",-1),s("p",null,"使用 nonce 确保所有节点计算相同的余额，并正确的对交易经行排序。相当于比特币中防止“双重支付”的机制。由于以太坊跟踪账户余额而不是独立的币（在比特币中被成为 UTXO ），所以只有在账户余额计算错误时才会发生“双花”，nonce 机制可以防止这种情况发生",-1),s("h4",{id:"跟踪-nonce",tabindex:"-1"},[a("跟踪 nonce "),s("a",{class:"header-anchor",href:"#跟踪-nonce","aria-label":'Permalink to "跟踪 nonce"'},"​")],-1),s("p",null,"编程式创建交易时，跟踪 nonce 是非常重要的。",-1),s("p",null,"以太坊网络根据 nonce 顺序处理交易，当接收到的交易 nonce 中断时，他会搁置交易直到接收到缺失的交易。",-1),s("h3",{id:"gas",tabindex:"-1"},[a("gas "),s("a",{class:"header-anchor",href:"#gas","aria-label":'Permalink to "gas"'},"​")],-1),s("p",null,"gas 是以太坊的燃料，区别于 ether， 它是独立的虚拟货币，有相对于 ether 的汇率。以太坊使用 gas 来控制交易可以花费的资源量（基于整个以太坊网络的算力）。开放式的计算模型需要某种形式的计量，以防拒绝服务攻击或资源吞噬攻击。",-1),s("p",null,"gas 与 ether 分离，以保护系统免受随着 ether 价值快速变化而产生的波动。",-1),s("p",null,[a("交易中的 "),s("code",null,"gas price"),a(" 字段允许交易发起者设置每单位 gas 的汇率，以控制交易的 gas 费用。越高的交易越容易被开采。")],-1),s("h3",{id:"交易的接收者",tabindex:"-1"},[a("交易的接收者 "),s("a",{class:"header-anchor",href:"#交易的接收者","aria-label":'Permalink to "交易的接收者"'},"​")],-1),s("p",null,"以太坊不验证接收地址的有效性，任何 20 字节的值都被认为是有效的。验证地址有效性这一步应在用户界面层级来完成。",-1),s("p",null,[a("发送至一个无效地址的 ether 将会被"),s("strong",null,"燃烧"),a("。燃烧 ether 被以太坊认为是合法且合理的行为。")],-1),s("h3",{id:"交易的价值和数据",tabindex:"-1"},[a("交易的价值和数据 "),s("a",{class:"header-anchor",href:"#交易的价值和数据","aria-label":'Permalink to "交易的价值和数据"'},"​")],-1),s("p",null,[s("code",null,"value"),a(" 与 "),s("code",null,"data"),a("，可以随意组合，可以两者都有，可以都没有。")],-1),s("p",null,[a("只有 value 的交易是"),s("em",null,"支付 payment"),a("，只有 data 的交易是"),s("em",null,"调用 invocation"),a("。既没有 value 也没有 data 的交易只能是浪费 gas，但它仍是可能的。")],-1),s("h4",{id:"特殊交易-合约注册",tabindex:"-1"},[a("特殊交易：合约注册 "),s("a",{class:"header-anchor",href:"#特殊交易-合约注册","aria-label":'Permalink to "特殊交易：合约注册"'},"​")],-1),s("p",null,[a("一种特殊的带有 data，没有 value 的交易。表示注册一个新的合约。合约注册交易被发送至一个特殊的地址，零地址："),s("code",null,"0x0"),a("。此地址既不代表 EOA 也不代表合约。")],-1),s("p",null,"合约注册交易不应该包含 ether value，只能包含合约编译字节码的data。合约需要编译为二进制码以十六进制表示。这可以被 Solidity 编译器完成。",-1),s("h3",{id:"数字签名",tabindex:"-1"},[a("数字签名 "),s("a",{class:"header-anchor",href:"#数字签名","aria-label":'Permalink to "数字签名"'},"​")],-1),s("p",null,"不泄漏私钥的情况下提供私钥所有权的证明（零知识证明）",-1),s("blockquote",null,[s("p",null,[a("数字签名是用于证明数字信息或文件真实性的数学方案。有效的数字签名使收件人有理由相信该信息是由已知的发件人（认证）创建的，发件人不能否认已发送的信息（不可否认），并且信息在传输过程中未被更改（完整性）。"),s("a",{href:"https://en.wikipedia.org/wiki/Digital_signature_",target:"_blank",rel:"noreferrer"},"wikipedia")])],-1),s("hr",null,null,-1),s("p",null,"数字签名是一种数学签名，由两部分组成：",-1),s("ul",null,[s("li",null,"使用私钥从消息中创建签名"),s("li",null,"任何人可以使用公钥+消息来验证签名有效性")],-1),s("h4",{id:"创建数字签名",tabindex:"-1"},[a("创建数字签名 "),s("a",{class:"header-anchor",href:"#创建数字签名","aria-label":'Permalink to "创建数字签名"'},"​")],-1),s("p",null,[a("以太坊实现的 "),s("code",null,"ECDSA"),a(" 中，被签名的“消息”是交易。准确的说，是来自交易的 RLP 编码数据的 "),s("code",null,"keccak256"),a(" 哈希。签名密钥是 EOA 的私钥。结果是签名。")],-1),s("p",null,[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"S"),s("mi",null,"i"),s("mi",null,"g"),s("mo",null,"="),s("msub",null,[s("mi",null,"F"),s("mrow",null,[s("mi",null,"s"),s("mi",null,"i"),s("mi",null,"g")])]),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"F"),s("mrow",null,[s("mi",null,"k"),s("mi",null,"e"),s("mi",null,"c"),s("mi",null,"c"),s("mi",null,"a"),s("mi",null,"k"),s("mn",null,"256")])]),s("mo",{stretchy:"false"},"("),s("mi",null,"m"),s("mo",{stretchy:"false"},")"),s("mo",{separator:"true"},","),s("mi",null,"k"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"Sig = F_{sig}(F_{keccak256}(m), k)")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8778em","vertical-align":"-0.1944em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathnormal"},"i"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.0361em","vertical-align":"-0.2861em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"F"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3117em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"s"),s("span",{class:"mord mathnormal mtight"},"i"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03588em"}},"g")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2861em"}},[s("span")])])])])]),s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"F"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mord mathnormal mtight"},"ecc"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"ak"),s("span",{class:"mord mtight"},"256")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"m"),s("span",{class:"mclose"},")"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mclose"},")")])])])],-1),s("ul",null,[s("li",null,[s("em",null,"k"),a(" 是签名私钥")]),s("li",null,[s("em",null,"m"),a(" 是RLP编码的交易")]),s("li",null,[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"F"),s("mrow",null,[s("mi",null,"k"),s("mi",null,"e"),s("mi",null,"c"),s("mi",null,"c"),s("mi",null,"a"),s("mi",null,"k"),s("mn",null,"256")])])]),s("annotation",{encoding:"application/x-tex"},"F_{keccak256}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"F"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mord mathnormal mtight"},"ecc"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03148em"}},"ak"),s("span",{class:"mord mtight"},"256")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])])]),a(" 是 Keccak256 哈希函数")]),s("li",null,[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"F"),s("mrow",null,[s("mi",null,"s"),s("mi",null,"i"),s("mi",null,"g")])])]),s("annotation",{encoding:"application/x-tex"},"F_{sig}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.9694em","vertical-align":"-0.2861em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"F"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3117em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"s"),s("span",{class:"mord mathnormal mtight"},"i"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03588em"}},"g")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2861em"}},[s("span")])])])])])])])]),a(" 是签名算法")]),s("li",null,[s("em",null,"Sig"),a(" 是由此产生的签名")])],-1),s("p",null,[a("函数 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"F"),s("mrow",null,[s("mi",null,"s"),s("mi",null,"i"),s("mi",null,"g")])])]),s("annotation",{encoding:"application/x-tex"},"F_{sig}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.9694em","vertical-align":"-0.2861em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"F"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3117em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"s"),s("span",{class:"mord mathnormal mtight"},"i"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03588em"}},"g")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2861em"}},[s("span")])])])])])])])]),a(" 产生一个由两个值组成的签名 "),s("em",null,"Sig"),a("，通常称为 "),s("em",null,"R"),a(" 和 "),s("em",null,"S")],-1),s("div",{class:"language- vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"    Sig = (R, S)")])])]),s("button",{class:"collapse"})],-1),s("h5",{id:"ecdsa-数学",tabindex:"-1"},[a("ECDSA 数学 "),s("a",{class:"header-anchor",href:"#ecdsa-数学","aria-label":'Permalink to "ECDSA 数学"'},"​")],-1),s("p",null,[a("签名算法首先生成一堆临时的私钥/公钥对。在涉及签名私钥和交易哈希转换之后，此临时密钥对用于计算 "),s("em",null,"R"),a(" 和 "),s("em",null,"S"),a(" 值。")],-1),s("p",null,"临时密钥对由两个输入值产生:",-1),s("ol",null,[s("li",null,[a("一个随机数 "),s("em",null,"q"),a(" ，用于临时私钥")]),s("li",null,[a("椭圆曲线生成点 "),s("em",null,"G")])],-1),s("p",null,[a("从 "),s("em",null,"q"),a(" 和 "),s("em",null,"G"),a(" 我们生成临时的公钥 "),s("em",null,"Q"),a(" （以 "),s("em",null,"Q = q * G"),a(" 计算，与以太坊公钥的派生方式相同）。数字签名的 "),s("em",null,"R"),a(" 值就是临时公钥 "),s("em",null,"Q"),a(" 的 x 坐标。")],-1),s("p",null,[a("然后算法计算签名的 "),s("em",null,"S"),a(" 值：")],-1),s("hr",null,null,-1),s("p",null,[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"S"),s("mo",null,"≡"),s("msup",null,[s("mi",null,"q"),s("mrow",null,[s("mo",null,"−"),s("mn",null,"1")])]),s("mo",{stretchy:"false"},"("),s("mi",null,"K"),s("mi",null,"e"),s("mi",null,"c"),s("mi",null,"c"),s("mi",null,"a"),s("mi",null,"k"),s("mn",null,"256"),s("mo",{stretchy:"false"},"("),s("mi",null,"m"),s("mo",{stretchy:"false"},")"),s("mo",null,"+"),s("mi",null,"k"),s("mo",null,"∗"),s("mi",null,"R"),s("mo",{stretchy:"false"},")"),s("mspace"),s("mspace",{width:"0.4444em"}),s("mo",{stretchy:"false"},"("),s("mrow",null,[s("mi",{mathvariant:"normal"},"m"),s("mi",{mathvariant:"normal"},"o"),s("mi",{mathvariant:"normal"},"d")]),s("mspace",{width:"0.3333em"}),s("mi",null,"p"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"S \\equiv q^{-1} (Keccak256(m) + k * R) \\pmod p")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"≡"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.0641em","vertical-align":"-0.25em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"q"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8141em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])])])])])]),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"Kecc"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"ak"),s("span",{class:"mord"},"256"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"m"),s("span",{class:"mclose"},")"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.00773em"}},"R"),s("span",{class:"mclose"},")"),s("span",{class:"mspace allowbreak"}),s("span",{class:"mspace",style:{"margin-right":"0.4444em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathrm"},"mod")])]),s("span",{class:"mspace",style:{"margin-right":"0.3333em"}}),s("span",{class:"mord mathnormal"},"p"),s("span",{class:"mclose"},")")])])])],-1),s("p",null,"其中：",-1),s("ul",null,[s("li",null,[s("em",null,"q"),a(" 是临时私钥，"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msup",null,[s("mi",null,"q"),s("mrow",null,[s("mo",null,"−"),s("mn",null,"1")])])]),s("annotation",{encoding:"application/x-tex"},"q^{-1}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.0085em","vertical-align":"-0.1944em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"q"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8141em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])])])])])])])])]),a(" 是 "),s("em",null,"q"),a(" 的模的乘法逆元")]),s("li",null,[s("em",null,"R"),a(" 是临时公钥的 x 坐标")]),s("li",null,[s("em",null,"k"),a(" 是签名 （EOA 所有者）的私钥")]),s("li",null,[s("em",null,"m"),a(" 是交易数据")]),s("li",null,[s("em",null,"p"),a(" 是椭圆曲线的素数阶")])],-1),s("hr",null,null,-1),s("p",null,[a("验证是签名生成函数的反函数，使用 "),s("em",null,"R"),a("，"),s("em",null,"S"),a(" 值和公钥来计算一个值 "),s("em",null,"Q"),a("，它是椭圆曲线上的一个点（签名创建时的临时公钥）:")],-1),s("p",null,[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"Q"),s("mo",null,"≡"),s("msup",null,[s("mi",null,"S"),s("mrow",null,[s("mo",null,"−"),s("mn",null,"1")])]),s("mo",null,"∗"),s("mi",null,"K"),s("mi",null,"e"),s("mi",null,"c"),s("mi",null,"c"),s("mi",null,"a"),s("mi",null,"k"),s("mn",null,"256"),s("mo",{stretchy:"false"},"("),s("mi",null,"m"),s("mo",{stretchy:"false"},")"),s("mo",null,"∗"),s("mi",null,"G"),s("mo",null,"+"),s("msup",null,[s("mi",null,"S"),s("mrow",null,[s("mo",null,"−"),s("mn",null,"1")])]),s("mo",null,"∗"),s("mi",null,"R"),s("mo",null,"∗"),s("mi",null,"K"),s("mspace"),s("mspace",{width:"0.4444em"}),s("mo",{stretchy:"false"},"("),s("mrow",null,[s("mi",{mathvariant:"normal"},"m"),s("mi",{mathvariant:"normal"},"o"),s("mi",{mathvariant:"normal"},"d")]),s("mspace",{width:"0.3333em"}),s("mi",null,"p"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"Q \\equiv S^{-1}*Keccak256(m)*G+S^{-1}*R*K\\pmod p")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8778em","vertical-align":"-0.1944em"}}),s("span",{class:"mord mathnormal"},"Q"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"≡"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8141em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8141em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal"},"Kecc"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"ak"),s("span",{class:"mord"},"256"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"m"),s("span",{class:"mclose"},")"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7667em","vertical-align":"-0.0833em"}}),s("span",{class:"mord mathnormal"},"G"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8141em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8141em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.00773em"}},"R"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),s("span",{class:"mspace allowbreak"}),s("span",{class:"mspace",style:{"margin-right":"0.4444em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathrm"},"mod")])]),s("span",{class:"mspace",style:{"margin-right":"0.3333em"}}),s("span",{class:"mord mathnormal"},"p"),s("span",{class:"mclose"},")")])])])],-1),s("p",null,"其中：",-1),s("ul",null,[s("li",null,[s("em",null,"R"),a(" 和 "),s("em",null,"S"),a(" 是签名值")]),s("li",null,[s("em",null,"K"),a(" 是签名者（EOA 所有者）的公钥")]),s("li",null,[s("em",null,"m"),a(" 是被签名的交易数据")]),s("li",null,[s("em",null,"G"),a(" 是椭圆曲线的生成点")]),s("li",null,[s("em",null,"p"),a(" 是椭圆曲线的素数阶")])],-1),s("p",null,[a("如果计算的点 "),s("em",null,"Q"),a(" 的 x 坐标等于 "),s("em",null,"R"),a("，则验证者可以断定该签名是有效的。")],-1),s("hr",null,null,-1),s("p",null,"互逆过程:",-1),s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mi",null,"Q"),s("mo",null,"≡"),s("msup",null,[s("mi",null,"S"),s("mrow",null,[s("mo",null,"−"),s("mn",null,"1")])]),s("mo",null,"∗"),s("mi",null,"K"),s("mi",null,"e"),s("mi",null,"c"),s("mi",null,"c"),s("mi",null,"a"),s("mi",null,"k"),s("mn",null,"256"),s("mo",{stretchy:"false"},"("),s("mi",null,"m"),s("mo",{stretchy:"false"},")"),s("mo",null,"∗"),s("mi",null,"G"),s("mo",null,"+"),s("msup",null,[s("mi",null,"S"),s("mrow",null,[s("mo",null,"−"),s("mn",null,"1")])]),s("mo",null,"∗"),s("mi",null,"R"),s("mo",null,"∗"),s("mi",null,"K"),s("mspace"),s("mspace",{width:"1em"}),s("mo",{stretchy:"false"},"("),s("mrow",null,[s("mi",{mathvariant:"normal"},"m"),s("mi",{mathvariant:"normal"},"o"),s("mi",{mathvariant:"normal"},"d")]),s("mspace",{width:"0.3333em"}),s("mi",null,"p"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"Q \\equiv S^{-1} * Keccak256(m) * G + S^{-1} * R * K \\pmod p ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8778em","vertical-align":"-0.1944em"}}),s("span",{class:"mord mathnormal"},"Q"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"≡"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8641em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8641em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal"},"Kecc"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"ak"),s("span",{class:"mord"},"256"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"m"),s("span",{class:"mclose"},")"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7667em","vertical-align":"-0.0833em"}}),s("span",{class:"mord mathnormal"},"G"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8641em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8641em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.00773em"}},"R"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K"),s("span",{class:"mspace allowbreak"}),s("span",{class:"mspace",style:{"margin-right":"1em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathrm"},"mod")])]),s("span",{class:"mspace",style:{"margin-right":"0.3333em"}}),s("span",{class:"mord mathnormal"},"p"),s("span",{class:"mclose"},")")])])])])],-1),s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mi",null,"q"),s("mo",null,"∗"),s("mi",null,"G"),s("mo",null,"≡"),s("msup",null,[s("mi",null,"S"),s("mrow",null,[s("mo",null,"−"),s("mn",null,"1")])]),s("mo",null,"∗"),s("mi",null,"K"),s("mi",null,"e"),s("mi",null,"c"),s("mi",null,"c"),s("mi",null,"a"),s("mi",null,"k"),s("mn",null,"256"),s("mo",{stretchy:"false"},"("),s("mi",null,"m"),s("mo",{stretchy:"false"},")"),s("mo",null,"∗"),s("mi",null,"G"),s("mo",null,"+"),s("msup",null,[s("mi",null,"S"),s("mrow",null,[s("mo",null,"−"),s("mn",null,"1")])]),s("mo",null,"∗"),s("mi",null,"R"),s("mo",null,"∗"),s("mi",null,"k"),s("mo",null,"∗"),s("mi",null,"G"),s("mspace"),s("mspace",{width:"1em"}),s("mo",{stretchy:"false"},"("),s("mrow",null,[s("mi",{mathvariant:"normal"},"m"),s("mi",{mathvariant:"normal"},"o"),s("mi",{mathvariant:"normal"},"d")]),s("mspace",{width:"0.3333em"}),s("mi",null,"p"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"q * G \\equiv S^{-1} * Keccak256(m) * G + S^{-1} * R * k * G \\pmod p ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6597em","vertical-align":"-0.1944em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"q"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"G"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"≡"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8641em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8641em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal"},"Kecc"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"ak"),s("span",{class:"mord"},"256"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"m"),s("span",{class:"mclose"},")"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7667em","vertical-align":"-0.0833em"}}),s("span",{class:"mord mathnormal"},"G"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8641em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8641em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.00773em"}},"R"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"G"),s("span",{class:"mspace allowbreak"}),s("span",{class:"mspace",style:{"margin-right":"1em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathrm"},"mod")])]),s("span",{class:"mspace",style:{"margin-right":"0.3333em"}}),s("span",{class:"mord mathnormal"},"p"),s("span",{class:"mclose"},")")])])])])],-1),s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mi",null,"q"),s("mo",null,"≡"),s("msup",null,[s("mi",null,"S"),s("mrow",null,[s("mo",null,"−"),s("mn",null,"1")])]),s("mo",null,"∗"),s("mo",{stretchy:"false"},"("),s("mi",null,"K"),s("mi",null,"e"),s("mi",null,"c"),s("mi",null,"c"),s("mi",null,"a"),s("mi",null,"k"),s("mn",null,"256"),s("mo",{stretchy:"false"},"("),s("mi",null,"m"),s("mo",{stretchy:"false"},")"),s("mo",null,"+"),s("mi",null,"R"),s("mo",null,"∗"),s("mi",null,"k"),s("mo",{stretchy:"false"},")"),s("mspace"),s("mspace",{width:"1em"}),s("mo",{stretchy:"false"},"("),s("mrow",null,[s("mi",{mathvariant:"normal"},"m"),s("mi",{mathvariant:"normal"},"o"),s("mi",{mathvariant:"normal"},"d")]),s("mspace",{width:"0.3333em"}),s("mi",null,"p"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"q \\equiv S^{-1} * (Keccak256(m) + R * k) \\pmod p ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6582em","vertical-align":"-0.1944em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"q"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"≡"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8641em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8641em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"Kecc"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"ak"),s("span",{class:"mord"},"256"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"m"),s("span",{class:"mclose"},")"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.00773em"}},"R"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mclose"},")"),s("span",{class:"mspace allowbreak"}),s("span",{class:"mspace",style:{"margin-right":"1em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathrm"},"mod")])]),s("span",{class:"mspace",style:{"margin-right":"0.3333em"}}),s("span",{class:"mord mathnormal"},"p"),s("span",{class:"mclose"},")")])])])])],-1),s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mi",null,"S"),s("mo",null,"≡"),s("msup",null,[s("mi",null,"q"),s("mrow",null,[s("mo",null,"−"),s("mn",null,"1")])]),s("mo",null,"∗"),s("mo",{stretchy:"false"},"("),s("mi",null,"K"),s("mi",null,"e"),s("mi",null,"c"),s("mi",null,"c"),s("mi",null,"a"),s("mi",null,"k"),s("mn",null,"256"),s("mo",{stretchy:"false"},"("),s("mi",null,"m"),s("mo",{stretchy:"false"},")"),s("mo",null,"+"),s("mi",null,"R"),s("mo",null,"∗"),s("mi",null,"k"),s("mo",{stretchy:"false"},")"),s("mspace"),s("mspace",{width:"1em"}),s("mo",{stretchy:"false"},"("),s("mrow",null,[s("mi",{mathvariant:"normal"},"m"),s("mi",{mathvariant:"normal"},"o"),s("mi",{mathvariant:"normal"},"d")]),s("mspace",{width:"0.3333em"}),s("mi",null,"p"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"S \\equiv q^{-1} * (Keccak256(m) + R * k) \\pmod p ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"≡"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.0585em","vertical-align":"-0.1944em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"q"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8641em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"Kecc"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"ak"),s("span",{class:"mord"},"256"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"m"),s("span",{class:"mclose"},")"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.00773em"}},"R"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mclose"},")"),s("span",{class:"mspace allowbreak"}),s("span",{class:"mspace",style:{"margin-right":"1em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathrm"},"mod")])]),s("span",{class:"mspace",style:{"margin-right":"0.3333em"}}),s("span",{class:"mord mathnormal"},"p"),s("span",{class:"mclose"},")")])])])])],-1),s("div",{class:"info custom-block"},[s("p",{class:"custom-block-title"},[s("span",{lang:"en"},"INFO"),s("span",{lang:"zh-CN"},"信息")]),s("p",null,"更多ECDSA相关查看"),s("p",null,[s("a",{href:"https://www.instructables.com/Understanding-how-ECDSA-protects-your-data/",target:"_blank",rel:"noreferrer"},"Understanding How ECDSA Protects Your Data.")]),s("p",null,[s("a",{href:"https://zhuanlan.zhihu.com/p/97953640",target:"_blank",rel:"noreferrer"},"一文读懂ECDSA算法如何保护数据")])],-1),s("h4",{id:"验证签名",tabindex:"-1"},[a("验证签名 "),s("a",{class:"header-anchor",href:"#验证签名","aria-label":'Permalink to "验证签名"'},"​")],-1),s("p",null,[a("要验证签名，必须有签名（R，S），序列化交易和公钥（与创建签名的私钥对应）。实质上，验证签名意味着只有生成此"),s("strong",null,"公钥"),a("的"),s("strong",null,"私钥所有者"),a("才能在此交易上产生签名。")],-1),s("h4",{id:"eip-155",tabindex:"-1"},[a("EIP-155 "),s("a",{class:"header-anchor",href:"#eip-155","aria-label":'Permalink to "EIP-155"'},"​")],-1),s("p",null,"在 #2,675,000 块，以太坊实施了“Spurious Dragon”硬分叉，除其他修改外，还推出了包括交易重播保护的新签名方案。",-1),s("p",null,[a("EIP-155 向交易数据结构添加了三个字段 "),s("em",null,"v"),a("，"),s("em",null,"r"),a(" 和 "),s("em",null,"s"),a("。"),s("em",null,"r"),a(" 和 "),s("em",null,"s"),a(" 被初始化为零，"),s("em",null,"v"),a(" 被初始化为链的唯一标识符。这三个字段在编码和散列"),s("strong",null,"之前"),a("被添加至交易数据中，因此哈希散列和签名会保证链标识符不会被篡改，提供“简单重播攻击保护”。")],-1),s("p",null,"发起交易的流程是：",-1),s("ol",null,[s("li",null,[a("创建一个含有九个字段的交易数据结构 "),s("ul",null,[s("li",null,"nonce"),s("li",null,"gasPrice"),s("li",null,"startGas"),s("li",null,"to"),s("li",null,"value"),s("li",null,"data"),s("li",null,"v"),s("li",null,"r"),s("li",null,"s")])]),s("li",null,"生成交易的 RLP 编码的序列化消息"),s("li",null,"计算此序列的 Keccak256 哈希"),s("li",null,"计算 ECDSA 签名，用发起 EOA 的私钥签名散列"),s("li",null,"在交易中插入 ECDSA 签名计算出的 r 和 s 值")],-1),s("h4",{id:"公钥恢复",tabindex:"-1"},[a("公钥恢复 "),s("a",{class:"header-anchor",href:"#公钥恢复","aria-label":'Permalink to "公钥恢复"'},"​")],-1),s("p",null,[a("给定 ECDSA 签名后，公钥可以直接从中计算出来，从而计算出发起交易者的 EOA 地址。这个过程称为 "),s("strong",null,"公钥恢复"),a("。")],-1),s("h4",{id:"离线签名",tabindex:"-1"},[a("离线签名 "),s("a",{class:"header-anchor",href:"#离线签名","aria-label":'Permalink to "离线签名"'},"​")],-1),s("p",null,"分离签名和传输功能称为离线签名，能够提高安全性。",-1),s("p",null,"隔离有不同程度的级别，从隔离和防火墙子网（在线但隔离）到完全脱机成为气隙 air gapped 系统。在气隙系统中没有网络连接，计算机与在线系统是“空气”隔离的，使用数据存储介质或者网络摄像头和QR码将交易记录到气隙计算机上，以签署交易。",-1),s("h3",{id:"交易传播",tabindex:"-1"},[a("交易传播 "),s("a",{class:"header-anchor",href:"#交易传播","aria-label":'Permalink to "交易传播"'},"​")],-1),s("p",null,"以太坊网络使用“范洪”路由协议，每个以太坊客户端作为节点（node）在点对点（Peer-to-Peer）系统中构成（mesh）网络。",-1),s("p",null,[a("交易传播开始于创建（或从离线接收）签名交易的以太坊节点。交易被验证，然后传送到 "),s("em",null,"直接"),a(" 连接到始发节点的所有以太坊节点。平均而言，每个以太坊节点至少保持着与其他13个节点的连接，称为 "),s("em",null,"邻居"),a("。每个邻居节点接收到交易后验证交易，如果他们认为交易是有效的，就会保留一份副本并将其传播给所有其他的邻居（除了接收交易来源的那个）。交易从始发节点象外涟漪式地遍历网络，直到网络中所有节点都拥有交易的副本。")],-1),s("p",null,"几秒钟之内，以太坊交易就会传播到全球的以太坊节点。从每个节点的角度来看，不可能辨别交易的起源，发送交易给他的节点可能是交易的发起者也可能是传播者。为了跟踪交易的起源或者干扰其传播，攻击者必须控制所有节点非常大的百分比，这是 P2P 网络安全和隐私设计的一部分。",-1)])),"main-header":l(()=>[m(n.$slots,"main-header")]),"main-header-after":l(()=>[m(n.$slots,"main-header-after")]),"main-nav":l(()=>[m(n.$slots,"main-nav")]),"main-content-before":l(()=>[m(n.$slots,"main-content-before")]),"main-content":l(()=>[m(n.$slots,"main-content")]),"main-content-after":l(()=>[m(n.$slots,"main-content-after")]),"main-nav-before":l(()=>[m(n.$slots,"main-nav-before")]),"main-nav-after":l(()=>[m(n.$slots,"main-nav-after")]),comment:l(()=>[m(n.$slots,"comment")]),footer:l(()=>[m(n.$slots,"footer")]),aside:l(()=>[m(n.$slots,"aside")]),"aside-custom":l(()=>[m(n.$slots,"aside-custom")]),default:l(()=>[m(n.$slots,"default")]),_:3},8,["frontmatter"])}}};export{C as default,x as usePageData};
